<!DOCTYPE html>
<html lang="English">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Setup | WirtBot</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Stay connected">
    
    <link rel="preload" href="/WirtBot/assets/css/0.styles.e0f7a0e5.css" as="style"><link rel="preload" href="/WirtBot/assets/js/app.e79d2299.js" as="script"><link rel="preload" href="/WirtBot/assets/js/2.d22509f0.js" as="script"><link rel="preload" href="/WirtBot/assets/js/31.36cb71ed.js" as="script"><link rel="prefetch" href="/WirtBot/assets/js/10.12b7164d.js"><link rel="prefetch" href="/WirtBot/assets/js/11.1f098c2e.js"><link rel="prefetch" href="/WirtBot/assets/js/12.fbf06305.js"><link rel="prefetch" href="/WirtBot/assets/js/13.48f9ca45.js"><link rel="prefetch" href="/WirtBot/assets/js/14.e9f4c3cd.js"><link rel="prefetch" href="/WirtBot/assets/js/15.0b184e28.js"><link rel="prefetch" href="/WirtBot/assets/js/16.ea10a1a3.js"><link rel="prefetch" href="/WirtBot/assets/js/17.e62f2bf2.js"><link rel="prefetch" href="/WirtBot/assets/js/18.a2764b97.js"><link rel="prefetch" href="/WirtBot/assets/js/19.654049ae.js"><link rel="prefetch" href="/WirtBot/assets/js/20.a0ffc349.js"><link rel="prefetch" href="/WirtBot/assets/js/21.bc534c35.js"><link rel="prefetch" href="/WirtBot/assets/js/22.3996dd7e.js"><link rel="prefetch" href="/WirtBot/assets/js/23.9de28c01.js"><link rel="prefetch" href="/WirtBot/assets/js/24.c0bd6233.js"><link rel="prefetch" href="/WirtBot/assets/js/25.d4c21c45.js"><link rel="prefetch" href="/WirtBot/assets/js/26.7dad4430.js"><link rel="prefetch" href="/WirtBot/assets/js/27.3f375362.js"><link rel="prefetch" href="/WirtBot/assets/js/28.ec53fd3b.js"><link rel="prefetch" href="/WirtBot/assets/js/29.187bbf55.js"><link rel="prefetch" href="/WirtBot/assets/js/3.784827f1.js"><link rel="prefetch" href="/WirtBot/assets/js/30.c091fa4b.js"><link rel="prefetch" href="/WirtBot/assets/js/32.4719edc4.js"><link rel="prefetch" href="/WirtBot/assets/js/33.04a45f96.js"><link rel="prefetch" href="/WirtBot/assets/js/4.a13b5eec.js"><link rel="prefetch" href="/WirtBot/assets/js/5.224f2be1.js"><link rel="prefetch" href="/WirtBot/assets/js/6.15f180ed.js"><link rel="prefetch" href="/WirtBot/assets/js/7.3129dccd.js"><link rel="prefetch" href="/WirtBot/assets/js/8.9e7c5cb7.js"><link rel="prefetch" href="/WirtBot/assets/js/9.840e5174.js">
    <link rel="stylesheet" href="/WirtBot/assets/css/0.styles.e0f7a0e5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/WirtBot/" class="home-link router-link-active"><img src="/WirtBot/logo.svg" alt="WirtBot" class="logo"> <span class="site-name can-hide">WirtBot</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/b-m-f/WirtBot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/WirtBot/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/WirtBot/screenshots.html" class="nav-link">
  Screenshots
</a></div><div class="nav-item"><a href="/WirtBot/announcements/" class="nav-link">
  Announcements
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/b-m-f/WirtBot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/WirtBot/documentation/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/WirtBot/screenshots.html" class="nav-link">
  Screenshots
</a></div><div class="nav-item"><a href="/WirtBot/announcements/" class="nav-link">
  Announcements
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/WirtBot/documentation/" aria-current="page" class="sidebar-link">What is it?</a></li><li><a href="/WirtBot/documentation/what-can-i-do-with-wirt.html" class="sidebar-link">What can you do with Wirt?</a></li><li><a href="/WirtBot/documentation/setup.html" aria-current="page" class="active sidebar-link">Setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/WirtBot/documentation/setup.html#dependencies" class="sidebar-link">Dependencies</a></li><li class="sidebar-sub-header"><a href="/WirtBot/documentation/setup.html#initial-setup" class="sidebar-link">Initial setup</a></li><li class="sidebar-sub-header"><a href="/WirtBot/documentation/setup.html#setting-up-your-network" class="sidebar-link">Setting up your network</a></li><li class="sidebar-sub-header"><a href="/WirtBot/documentation/setup.html#advanced" class="sidebar-link">Advanced</a></li></ul></li><li><a href="/WirtBot/documentation/join-a-network.html" class="sidebar-link">Join a network</a></li><li><a href="/WirtBot/documentation/system-overview.html" class="sidebar-link">System Overview</a></li><li><a href="/WirtBot/documentation/faq.html" class="sidebar-link">FAQ</a></li><li><a href="/WirtBot/documentation/issues.html" class="sidebar-link">New features &amp; Bugs</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="setup"><a href="#setup" class="header-anchor">#</a> Setup</h1> <h2 id="dependencies"><a href="#dependencies" class="header-anchor">#</a> Dependencies</h2> <p>To set up a WirtBot you must first make sure that your machine has the following dependencies installed:</p> <ul><li>Linux Kernel &gt; 5.6 or the WireGuard® Kernel Module</li> <li>Docker</li> <li>docker-compose</li></ul> <h2 id="initial-setup"><a href="#initial-setup" class="header-anchor">#</a> Initial setup</h2> <p>Here is an example <code>docker-compose.yml</code> for a WirtBot with DNS and SSL enabled:</p> <div class="language- extra-class"><pre class="language-text"><code>version: &quot;3.4&quot;

services:
  WirtBot:
    image: bmff/wirtbot:latest
    container_name: WirtBot
    ports:
      - 53:53
      - 80:80
      - 3030:3030
      - 10101:10101/udp
    restart: &quot;unless-stopped&quot;
    cap_add:
      - NET_ADMIN
    sysctls:
      - net.ipv6.conf.all.disable_ipv6=0
    environment:
      - &quot;ALLOWED_ORIGIN=http://IP/HOSTNAME_OF_THE_WIRTBOT_HOST_MACHINE&quot;
    volumes:
      - wireguard-data:/etc/wireguard
      - coredns-data:/etc/coredns
volumes:
  wireguard-data:
  coredns-data:

</code></pre></div><p>Copy this configuration into a file on the machine, update the &quot;ALLOWED_ORIGIN&quot; variable and run <code>docker-compose up -d</code>.
Docker will now take care of downloading the WirtBot and CoreDNS containers and wiring them up.</p> <p>You can check the progress with <code>docker logs -f WirtBot</code>.
Once the setup is finished you should see a message like this:</p> <div class="language- extra-class"><pre class="language-text"><code>A new keypair for communication between Core and UI was generated
Please import the following text into your dashboard to take control of this WirtBot
</code></pre></div><p>followed by a long string.</p> <p>To take control of the WirtBot via your browser you can now reach the Interface at the IP address of your machine in the browser.
Simple paste the above mentioned string into the input box that should be shown to you and click on the <code>Connect</code> button.</p> <p>The last thing to do is to set the <strong>Hostname/IP Address</strong> of the machine that WirtBot is running on <strong>as the API endpoint</strong>. You can do this in the network part of the Dashboard.</p> <p>Done. You are now in control of the WirtBot via your browser.</p> <h2 id="setting-up-your-network"><a href="#setting-up-your-network" class="header-anchor">#</a> Setting up your network</h2> <p>Now it is time to set up your network. Fill out the server section first, according to your needs. In the example configuration WireGuard will be listening at <strong>Port 10101</strong>.</p> <p>After adding the server you can go ahead and add as many devices as you want.</p> <p>You should also take note of the <strong>Public Key</strong> that is shown to you in the <strong>Settings</strong> section of the Dasboard.
In order to stay in control of the WirtBot when it restarts you <strong>MUST</strong> tell it to keep trusting this Key.</p> <p>Do this by adding it to the environment variables in the <code>docker-compose</code> file like so:</p> <div class="language- extra-class"><pre class="language-text"><code>environment:
  - &quot;PUBLIC_KEY=your_public_key_from_the_settings_section&quot;
</code></pre></div><p>Run <code>docker-compose up -d</code> again to start the WirtBot with the given public key.</p> <blockquote><p>Simply restarting the container is not enough! A new one needs to be started to consume the right environment variables</p></blockquote> <p>Now that the network is established and the configuration persisted you might want to start closing down the Interface and WirtBot via Firewall rules.
You should also make a Backup via the UI and keep it in safe place.</p> <h2 id="advanced"><a href="#advanced" class="header-anchor">#</a> Advanced</h2> <h3 id="ssl-encryption"><a href="#ssl-encryption" class="header-anchor">#</a> SSL encryption</h3> <p>In order to activate SSL for both the Core and Interface you can set the following environment variables:</p> <div class="language- extra-class"><pre class="language-text"><code>- &quot;SSL_INTERFACE=true&quot;
- &quot;SSL_CORE=true&quot;

</code></pre></div><p>When set you must ensure that the keys are mounted into the container in the correct locations.
Here is an example:</p> <div class="language- extra-class"><pre class="language-text"><code>- /etc/ssl/keys/public.key:/core/public_key
- /etc/ssl/keys/private.key:/core/private_key
- /etc/ssl/keys/public.key:/interface/public_key
- /etc/ssl/keys/private.key:/interface/private_key
</code></pre></div><p>The Keypair can be the same for the core and interface but must be mounted to different locations in the container. This is due to both core and interface running with different users and permissions.</p> <h3 id="monitoring"><a href="#monitoring" class="header-anchor">#</a> Monitoring</h3> <p>Endpoints for Prometheus metrics are enabled in the Container:</p> <ul><li>9153: CoreDNS metrics</li> <li>9586: WireGuard metrics</li></ul> <p>If your prometheus instance is connected into the network you can simply get them from the default WirtBot address at <code>10.10.0.1</code> or <code>wirtbot.wirt.internal</code>.</p> <p>You can also choose to expose them via the <code>docker-compose.yml</code> file if you prefer. The Dockerfile specifies them as exposed ports.</p> <h3 id="securing-the-wirtbot-after-setup"><a href="#securing-the-wirtbot-after-setup" class="header-anchor">#</a> Securing the WirtBot after setup</h3> <p>In order to make the WirtBot interace and API hidden on the Host machine simply <strong>remove the port bindings</strong> for port <strong>80</strong> and <strong>3030</strong>.</p> <p>Both will still be reachable via the private network that was created with the WirtBot at <code>wirtbot.wirt.internal</code>.</p> <p>In order to use the internal zone update</p> <div class="language- extra-class"><pre class="language-text"><code> - &quot;ALLOWED_ORIGIN=http://IP/HOSTNAME_OF_THE_WIRTBOT_HOST_MACHINE&quot;
</code></pre></div><p>to</p> <div class="language- extra-class"><pre class="language-text"><code> - &quot;ALLOWED_ORIGIN=wirtbot.wirt.internal&quot;
</code></pre></div><p>and <strong>change the API Endpoint</strong> the Dashboard to <code>wirtbot.wirt.internal</code></p> <h3 id="host-mode-for-more-speed"><a href="#host-mode-for-more-speed" class="header-anchor">#</a> Host mode for more speed</h3> <p>In order to bypass a few network loops between the Host machine and the WirtBot container you can set</p> <div class="language- extra-class"><pre class="language-text"><code>network_mode: host
</code></pre></div><p>in your <code>docker-compose.yml</code> file. This will directly bind the Host ports to the container and in addition the WireGuard interface will be created directly on the host as well.</p> <p><strong>This also means that your host could talk to the network. But no routing is setup and this needs to be done manually if that is desired</strong></p> <h3 id="mounting-the-configuration-files-to-the-host"><a href="#mounting-the-configuration-files-to-the-host" class="header-anchor">#</a> Mounting the configuration files to the host</h3> <p>For backup purposes you can mount the following files to your host:</p> <ul><li>WireGuard config: <code>/etc/wireguard/server.conf</code></li> <li>CoreDNS config: <code>/etc/coredns/Corefile</code></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/WirtBot/documentation/what-can-i-do-with-wirt.html" class="prev">
        What can you do with Wirt?
      </a></span> <span class="next"><a href="/WirtBot/documentation/join-a-network.html">
        Join a network
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/WirtBot/assets/js/app.e79d2299.js" defer></script><script src="/WirtBot/assets/js/2.d22509f0.js" defer></script><script src="/WirtBot/assets/js/31.36cb71ed.js" defer></script>
  </body>
</html>
