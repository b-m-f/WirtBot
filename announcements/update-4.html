<!DOCTYPE html>
<html lang="English">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Update 4: V2 of the WirtBot lost some weight | WirtBot</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Stay connected">
    
    <link rel="preload" href="/WirtBot/assets/css/0.styles.e0f7a0e5.css" as="style"><link rel="preload" href="/WirtBot/assets/js/app.62b5b6cf.js" as="script"><link rel="preload" href="/WirtBot/assets/js/2.d22509f0.js" as="script"><link rel="preload" href="/WirtBot/assets/js/21.0d5175e8.js" as="script"><link rel="prefetch" href="/WirtBot/assets/js/10.12b7164d.js"><link rel="prefetch" href="/WirtBot/assets/js/11.d5b5ebc0.js"><link rel="prefetch" href="/WirtBot/assets/js/12.fbf06305.js"><link rel="prefetch" href="/WirtBot/assets/js/13.48f9ca45.js"><link rel="prefetch" href="/WirtBot/assets/js/14.e9f4c3cd.js"><link rel="prefetch" href="/WirtBot/assets/js/15.61725f52.js"><link rel="prefetch" href="/WirtBot/assets/js/16.04151b9b.js"><link rel="prefetch" href="/WirtBot/assets/js/17.7ebc972a.js"><link rel="prefetch" href="/WirtBot/assets/js/18.bbc43df8.js"><link rel="prefetch" href="/WirtBot/assets/js/19.2de3f8f2.js"><link rel="prefetch" href="/WirtBot/assets/js/20.f38df0ef.js"><link rel="prefetch" href="/WirtBot/assets/js/22.b0c88684.js"><link rel="prefetch" href="/WirtBot/assets/js/23.4cf91033.js"><link rel="prefetch" href="/WirtBot/assets/js/24.650ac61c.js"><link rel="prefetch" href="/WirtBot/assets/js/25.17e52f80.js"><link rel="prefetch" href="/WirtBot/assets/js/26.d54953d1.js"><link rel="prefetch" href="/WirtBot/assets/js/27.a97e3b5d.js"><link rel="prefetch" href="/WirtBot/assets/js/28.b71808b4.js"><link rel="prefetch" href="/WirtBot/assets/js/29.7bd2c1a5.js"><link rel="prefetch" href="/WirtBot/assets/js/3.892a1b79.js"><link rel="prefetch" href="/WirtBot/assets/js/30.888f838d.js"><link rel="prefetch" href="/WirtBot/assets/js/31.73b11b78.js"><link rel="prefetch" href="/WirtBot/assets/js/32.e71517af.js"><link rel="prefetch" href="/WirtBot/assets/js/4.a13b5eec.js"><link rel="prefetch" href="/WirtBot/assets/js/5.224f2be1.js"><link rel="prefetch" href="/WirtBot/assets/js/6.15f180ed.js"><link rel="prefetch" href="/WirtBot/assets/js/7.3129dccd.js"><link rel="prefetch" href="/WirtBot/assets/js/8.7e676f42.js"><link rel="prefetch" href="/WirtBot/assets/js/9.840e5174.js">
    <link rel="stylesheet" href="/WirtBot/assets/css/0.styles.e0f7a0e5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/WirtBot/" class="home-link router-link-active"><img src="/WirtBot/logo.svg" alt="WirtBot" class="logo"> <span class="site-name can-hide">WirtBot</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/b-m-f/WirtBot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/WirtBot/documentation/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/WirtBot/screenshots.html" class="nav-link">
  Screenshots
</a></div><div class="nav-item"><a href="/WirtBot/announcements/" class="nav-link router-link-active">
  Announcements
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/b-m-f/WirtBot" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/WirtBot/documentation/" class="nav-link">
  Documentation
</a></div><div class="nav-item"><a href="/WirtBot/screenshots.html" class="nav-link">
  Screenshots
</a></div><div class="nav-item"><a href="/WirtBot/announcements/" class="nav-link router-link-active">
  Announcements
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/WirtBot/announcements/update-6.html" class="sidebar-link">Update 6: More focus, less bugs</a></li><li><a href="/WirtBot/announcements/update-5.html" class="sidebar-link">Update 5: Time to maintain</a></li><li><a href="/WirtBot/announcements/update-4.html" aria-current="page" class="active sidebar-link">Update 4: WirtBot weight loss and a nasty bug</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/WirtBot/announcements/update-4.html#new-setup-flow" class="sidebar-link">New setup flow</a></li><li class="sidebar-sub-header"><a href="/WirtBot/announcements/update-4.html#other-changes" class="sidebar-link">Other changes</a></li><li class="sidebar-sub-header"><a href="/WirtBot/announcements/update-4.html#end" class="sidebar-link">End</a></li></ul></li><li><a href="/WirtBot/announcements/update-3.html" class="sidebar-link">Update 3: With confidence into the unknown</a></li><li><a href="/WirtBot/announcements/22-11-20.html" class="sidebar-link">22.11.20: Installer change and major Interface + System-Tests refactor</a></li><li><a href="/WirtBot/announcements/8-11-20.html" class="sidebar-link">8.11.20: New name for installer binary</a></li><li><a href="/WirtBot/announcements/31-10-20.html" class="sidebar-link">31.10.20: All aboard the container</a></li><li><a href="/WirtBot/announcements/21-10-20.html" class="sidebar-link">21.10.20: Please update your installer</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="update-4-v2-of-the-wirtbot-lost-some-weight"><a href="#update-4-v2-of-the-wirtbot-lost-some-weight" class="header-anchor">#</a> Update 4: V2 of the WirtBot lost some weight</h1> <p>After using the WirtBot for a while I noticed the cruft I loaded onto myself.</p> <p>Maintaining the WirtBot + ansible scripts etc. while already having it containerized and the audience, despite my attempts to make it simple to use, being highly technical nonetheless just made no sense.</p> <p>If you use this tech you probably already have a pretty good grasp of Linux and networks.</p> <p>So <strong>the installer is removed</strong> and you can integrate the Docker container on your machines even easier.</p> <h2 id="new-setup-flow"><a href="#new-setup-flow" class="header-anchor">#</a> New setup flow</h2> <p>When running the WirtBot container for the first time, meaning that you probably do not have a public key for your interface yet, it will automatically generate a keypair for you.</p> <p>This is printed into the logs and can be used to take control of the interface.
Meaning that the setup is still as secure as possible, while staying straigt forward.</p> <p>Accompanying the changes on the server is a new page on the Interface to help importing the keys.
If you happen to have a backup and started the WirtBot with a public key already in its environment you can of course simply skip this.</p> <h2 id="other-changes"><a href="#other-changes" class="header-anchor">#</a> Other changes</h2> <h3 id="updated-dependencies"><a href="#updated-dependencies" class="header-anchor">#</a> updated dependencies</h3> <p>With <a href="https://tokio.rs/" target="_blank" rel="noopener noreferrer">tokio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> hitting <strong>1.0</strong> and <a href="https://docs.rs/warp/0.3.0/warp/" target="_blank" rel="noopener noreferrer">warp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> integrating it both have been updated to the latest versions.</p> <h3 id="bug-fixes"><a href="#bug-fixes" class="header-anchor">#</a> Bug fixes</h3> <p>There was a bug when importing backups.
In order to understand it you must know how the backup process actually works:</p> <ul><li>read backup</li> <li>do some automatic upgrading depending on backup version</li> <li>remove all server configuration from the state</li> <li>remove all device configs from the state</li> <li>add the server from the backup via normal state dispatching</li> <li>add all devices 1 by 1 using the normal state dispatching</li></ul> <p>The bug was hiding in the device adding part. As new devices were assumed to not have keys when I originally wrote the function, this function would generate them every time.
This in turn means that the server would not recognize the devices anymore as their keys seemed to have updated and you got locked out of the WirtBot.</p> <p>Making sure that keys are only regenerated when needed took care of this issue.</p> <h3 id="better-feedback"><a href="#better-feedback" class="header-anchor">#</a> Better feedback</h3> <p>Alerts have been added to show up when the configuration on the WirtBot has been updated successfully or failed for some reason.</p> <h3 id="relative-routing"><a href="#relative-routing" class="header-anchor">#</a> Relative Routing</h3> <p>To properly function behind any kind of proxy you might want to use for the interface the routing mode is now set to relative routing.</p> <p>This should make it possible to proxy to and from the Interface without problems.</p> <h3 id="custom-api-endpoint"><a href="#custom-api-endpoint" class="header-anchor">#</a> Custom API Endpoint</h3> <p>Since the ansible script and automatic network creation on install are gone it is necessary to be able to specify where updates should be send.</p> <p>The interface now has an option to specify the hostname/IP of the WirtBot.</p> <h3 id="multiarch"><a href="#multiarch" class="header-anchor">#</a> Multiarch</h3> <p>WirtBot can now run on both AMD64 and ARM64.</p> <p>Unfortunately this makes the build-pipeline quite slow, but hey atleast you can now run the WirtBot on ARM devices if you want.</p> <h2 id="end"><a href="#end" class="header-anchor">#</a> End</h2> <p>Thats it. Well except for the updated setup documentation that is.</p> <p>And what is next, now that there is less to take care of?</p> <p>I am thinking of Metrics, but it might take another couple of months.</p> <p>Til then, happy hacking.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/WirtBot/announcements/update-5.html" class="prev">
        Update 5: Time to maintain
      </a></span> <span class="next"><a href="/WirtBot/announcements/update-3.html">
        Update 3: With confidence into the unknown
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/WirtBot/assets/js/app.62b5b6cf.js" defer></script><script src="/WirtBot/assets/js/2.d22509f0.js" defer></script><script src="/WirtBot/assets/js/21.0d5175e8.js" defer></script>
  </body>
</html>
